<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  window.dataLayer = window.dataLayer || [];
</script>

<!-- Google Tag Manager -->
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];
w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
var f=d.getElementsByTagNameName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-574TC2N4');
</script>

<style>
body { font-family: Arial; padding:40px; }
.btn { padding:10px 16px; background:#f5c400; border:none; cursor:pointer; }
</style>
</head>

<body>

<h2 id="welcomeText"></h2>
<button id="loginBtn" class="btn" onclick="goLogin()">Login</button>
<button id="logoutBtn" class="btn" onclick="logout()">Logout</button>

<script>
/* ================= CHECK LOGIN STATE ================= */
const userId = localStorage.getItem("loggedInUser");
const welcomeText = document.getElementById("welcomeText");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");

if (userId) {
  /* USER LOGGED IN */
  welcomeText.innerText = "Welcome back ðŸ‘‹";
  loginBtn.style.display = "none";
  logoutBtn.style.display = "inline-block";

  dataLayer.push({
    event: "page_view",
    pageName: "ShopEase:Home",
    userId: userId,
    userType: "registered",
    loginStatus: "logged_in"
  });

} else {
  /* GUEST */
  welcomeText.innerText = "Welcome Guest ðŸ‘‹";
  loginBtn.style.display = "inline-block";
  logoutBtn.style.display = "none";

  dataLayer.push({
    event: "page_view",
    pageName: "ShopEase:Home",
    userId: null,
    userType: "guest",
    loginStatus: "logged_out"
  });
}

function goLogin() {
  window.location.href = "login.html";
}

function logout() {
  localStorage.removeItem("loggedInUser");

  dataLayer.push({
    event: "logout",
    userId: null,
    userType: "guest",
    loginStatus: "logged_out"
  });

  window.location.reload();
}
</script>

</body>
</html>
