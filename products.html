<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopEase - Products</title>

    <!-- ðŸ”´ GTM ADDED: dataLayer init -->
    <script>
      window.dataLayer = window.dataLayer || [];
    </script>

    <!-- ðŸ”´ GTM ADDED: page load -->
    <script>
      dataLayer.push({
        event: "pageView",
        pageName: "ShopEase:Products",
        pageType: "product-listing",
          siteName: "ShopEase",
          language: "en-US"
          
      });
    </script>

    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-574TC2N4');</script>
<!-- End Google Tag Manager -->

    <!-- ===== ORIGINAL DIGITAL DATA (UNCHANGED) ===== -->
    <script>
      window.digitalData = {
        page: {
          pageInfo: {
            pageName: "product listing",
            pageType: "category",
            language: "en-US",
            siteSection: "products",
            siteName: "ShopEase",
            environment: "development"
          }
        },
        user: {
          profile: [{
            profileInfo: {
              userId: null,
              userType: "guest"
            }
          }]
        },
        cart: {
          cartID: null,
          cartTotal: 0,
          cartItems: 0
        },
        event: []
      };
    </script>

    <script src="https://assets.adobedtm.com/21b53c73144b/55224bfc5f5a/launch-6c2cbecd161e-development.min.js" async></script>

    <!-- ===== ORIGINAL STYLES (UNCHANGED) ===== -->
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Arial', sans-serif; }
        body { 
            background-color: #f9f9f9;
            background-image: url('https://www.transparenttextures.com/patterns/brushed-alum.png');
        }
        header { 
            background: rgba(51, 51, 51, 0.9); 
            color: white; 
            padding: 1rem; 
            display: flex; 
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        nav ul { display: flex; list-style: none; }
        nav ul li { margin-left: 1.5rem; }
        nav a { color: white; text-decoration: none; }
        .main-content { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 2rem; }
        .product-card { background: white; border-radius: 8px; cursor: pointer; }
    </style>
</head>

<body>

<header>
    <h1>ShopEase</h1>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="checkout.html">Cart (0)</a></li>
        </ul>
    </nav>
</header>

<div class="main-content">
    <div class="products-grid" id="productsGrid"></div>
</div>

<script>
/* ===== ORIGINAL PRODUCT CODE (UNCHANGED) ===== */
const products = [
  { id: 1, name: "Wireless Headphones", price: 59.99, category: "electronics", image: "" },
  { id: 2, name: "Smart Watch", price: 129.99, category: "electronics", image: "" }
];

function displayProducts(filteredProducts) {
  const productsGrid = document.getElementById('productsGrid');
  productsGrid.innerHTML = '';

  filteredProducts.forEach(product => {
    const productCard = document.createElement('div');
    productCard.className = 'product-card';
    productCard.innerHTML = `
      <h3>${product.name}</h3>
      <p>$${product.price}</p>
    `;

    productCard.addEventListener('click', () => {

      /* ðŸ”´ GTM ADDED: product click */
      dataLayer.push({
        event: "productClick",
        productId: product.id,
        productName: product.name,
        productPrice: product.price
      });

      window.location.href = `product.html?id=${product.id}`;
    });

    productsGrid.appendChild(productCard);
  });
}

displayProducts(products);

/* ðŸ”´ GTM ADDED: all link clicks */
document.addEventListener("click", function(e){
  const link = e.target.closest("a");
  if(!link) return;

  dataLayer.push({
    event: "linkClick",
    linkText: link.innerText.trim(),
    linkUrl: link.getAttribute("href")
  });
});

/* ðŸ”´ GTM ADDED: filter change */
document.getElementById("category")?.addEventListener("change", function(){
  dataLayer.push({
    event: "filterApplied",
    filterType: "category",
    filterValue: this.value
  });
});

document.getElementById("price")?.addEventListener("input", function(){
  dataLayer.push({
    event: "filterApplied",
    filterType: "price",
    filterValue: this.value
  });
});
</script>

</body>
</html>
