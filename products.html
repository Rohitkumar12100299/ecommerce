<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopEase - Products</title>

    <!-- ================= GTM DATA LAYER ================= -->
    <script>
      window.dataLayer = window.dataLayer || [];
    </script>

    <!-- ================= PAGE LOAD (PLP) ================= -->
    <script>
      dataLayer.push({
        event: "pageView",
        pageName: "ShopEase:Products",
        pageType: "product-listing",
        siteSection: "products",
        siteName: "ShopEase"
      });
    </script>

    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-574TC2N4');</script>
<!-- End Google Tag Manager -->

    <!-- ================= ADOBE DIGITAL DATA ================= -->
    <script>
      window.digitalData = {
        page: {
          pageInfo: {
            pageName: "product listing",
            pageType: "category",
            language: "en-US",
            siteSection: "products",
            siteName: "ShopEase",
            environment: "development"
          }
        },
        user: {
          profile: [{
            profileInfo: {
              userId: null,
              userType: "guest"
            }
          }]
        },
        cart: {
          cartID: null,
          cartTotal: 0,
          cartItems: 0
        },
        event: []
      };
    </script>

    <!-- ================= ADOBE LAUNCH ================= -->
    <script src="https://assets.adobedtm.com/21b53c73144b/55224bfc5f5a/launch-6c2cbecd161e-development.min.js" async></script>

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: Arial, sans-serif; }
        body { background-color: #f9f9f9; }
        header { background: rgba(51,51,51,0.9); color: white; padding: 1rem; display: flex; justify-content: space-between; position: sticky; top: 0; }
        nav ul { display: flex; list-style: none; }
        nav ul li { margin-left: 1.5rem; }
        nav a { color: white; text-decoration: none; }
        nav a:hover { color: #4CAF50; }

        .main-content { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .page-title { text-align: center; margin-bottom: 2rem; }

        .filters { background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; }
        label { display: block; margin-bottom: 0.5rem; }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .product-card img { width: 100%; height: 200px; object-fit: cover; }
        .product-info { padding: 1.5rem; }

        footer { background: #333; color: white; text-align: center; padding: 2rem; margin-top: 3rem; }
    </style>
</head>

<body>

<header>
    <h1>ShopEase</h1>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="checkout.html">Cart (0)</a></li>
        </ul>
    </nav>
</header>

<div class="main-content">
    <h1 class="page-title">Our Products</h1>

    <section class="filters">
        <label>Category</label>
        <select id="category">
            <option value="all">All</option>
            <option value="electronics">Electronics</option>
            <option value="clothing">Clothing</option>
            <option value="home">Home</option>
        </select>
    </section>

    <div class="products-grid" id="productsGrid"></div>
</div>

<footer>
    <p>&copy; 2023 ShopEase</p>
</footer>

<script>
/* ================= PRODUCT DATA ================= */
const products = [
  { id: 1, name: "Wireless Headphones", price: 59.99, category: "electronics" },
  { id: 2, name: "Smart Watch", price: 129.99, category: "electronics" },
  { id: 3, name: "Cotton T-Shirt", price: 19.99, category: "clothing" }
];

/* ================= RENDER PRODUCTS ================= */
function displayProducts(list) {
  const grid = document.getElementById("productsGrid");
  grid.innerHTML = "";

  list.forEach(p => {
    const div = document.createElement("div");
    div.className = "product-card";
    div.innerHTML = `
      <div class="product-info">
        <h3>${p.name}</h3>
        <p>$${p.price}</p>
      </div>
    `;

    div.addEventListener("click", () => {

      /* ===== GTM PRODUCT CLICK ===== */
      dataLayer.push({
        event: "productClick",
        productId: p.id,
        productName: p.name,
        productPrice: p.price,
        pageName: "ShopEase:Products"
      });

      window.location.href = `product.html?id=${p.id}`;
    });

    grid.appendChild(div);
  });
}

displayProducts(products);

/* ================= FILTER CHANGE ================= */
document.getElementById("category").addEventListener("change", function () {
  const val = this.value;

  dataLayer.push({
    event: "filterApplied",
    filterType: "category",
    filterValue: val,
    pageName: "ShopEase:Products"
  });

  if (val === "all") displayProducts(products);
  else displayProducts(products.filter(p => p.category === val));
});

/* ================= GTM LINK CLICK ================= */
document.addEventListener("click", function (e) {
  const link = e.target.closest("a");
  if (!link) return;

  dataLayer.push({
    event: "linkClick",
    linkText: link.innerText.trim(),
    linkUrl: link.getAttribute("href"),
    pageName: "ShopEase:Products"
  });
});

/* ================= CART COUNT ================= */
let cartCount = localStorage.getItem("cartCount") || 0;
document.querySelector("nav ul li:last-child a").textContent = `Cart (${cartCount})`;

</script>

</body>
</html>
