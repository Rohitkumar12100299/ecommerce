<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ShopEase - Home</title>

  <!-- GTM -->
  <script>
    window.dataLayer = window.dataLayer || [];
  </script>

  <script>
    dataLayer.push({
      event: "pageView",
      pageName: "ShopEase:Home"
    });
  </script>

  <!-- DIGITAL DATA -->
  <script>
    window.digitalData = {
      page: { pageInfo: { pageName: "ShopEase:Home" } },
      event: []
    };

    (function () {
      const p = digitalData.event.push;
      digitalData.event.push = function () {
        p.apply(this, arguments);
        window.dispatchEvent(new CustomEvent("digitalDataEventPushed", {
          detail: arguments[0]
        }));
      };
    })();
  </script>

  <style>
    * { box-sizing: border-box; margin:0; padding:0; font-family:Arial }
    body { background:#f9f9f9 }

    header {
      background: rgba(51,51,51,.9);
      color:#fff;
      padding:1rem;
      display:flex;
      justify-content:space-between;
    }

    nav ul { list-style:none; display:flex }
    nav li { margin-left:1.5rem }
    nav a { color:white; text-decoration:none }

    .hero {
      background:linear-gradient(rgba(0,0,0,.5),rgba(0,0,0,.5)),
      url('https://images.unsplash.com/photo-1555529669-e69e7aa0ba9a');
      background-size:cover;
      height:60vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      color:white;
    }
  </style>
</head>

<body>

<header>
  <h1>Rohit Ki Dukan</h1>
  <nav>
    <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">Shop</a></li>

      <!-- AUTH BUTTONS -->
      <li id="signupBtn"><a href="javascript:void(0)" onclick="openSignup()">Sign Up</a></li>
      <li id="loginBtn"><a href="javascript:void(0)" onclick="openLogin()">Login</a></li>
      <li id="logoutBtn" style="display:none">
        <a href="javascript:void(0)" onclick="logout()">Logout</a>
      </li>
    </ul>
  </nav>
</header>

<section class="hero">
  <h2>Welcome to ShopEase</h2>
</section>

<!-- ================= SIGNUP MODAL ================= -->
<div id="signupModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);justify-content:center;align-items:center">
  <div style="background:#fff;padding:20px;width:300px">
    <h3>Sign Up</h3>
    <input id="suEmail" placeholder="Email" style="width:100%;margin:6px 0">
    <input id="suPass" type="password" placeholder="Password" style="width:100%;margin:6px 0">
    <button onclick="signup()" style="width:100%">Create Account</button>
  </div>
</div>

<!-- ================= LOGIN MODAL ================= -->
<div id="loginModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);justify-content:center;align-items:center">
  <div style="background:#fff;padding:20px;width:300px">
    <h3>Login</h3>
    <input id="liEmail" placeholder="Email" style="width:100%;margin:6px 0">
    <input id="liPass" type="password" placeholder="Password" style="width:100%;margin:6px 0">
    <button onclick="login()" style="width:100%">Login</button>
  </div>
</div>

<script>
/* ---------- HELPERS ---------- */
function getUsers() {
  return JSON.parse(localStorage.getItem("users") || "[]");
}
function saveUsers(u) {
  localStorage.setItem("users", JSON.stringify(u));
}

/* ---------- UI STATE ---------- */
function updateAuthUI() {
  const loggedIn = localStorage.getItem("loggedInUser");
  signupBtn.style.display = loggedIn ? "none" : "block";
  loginBtn.style.display = loggedIn ? "none" : "block";
  logoutBtn.style.display = loggedIn ? "block" : "none";
}
updateAuthUI();

/* ---------- OPEN MODALS ---------- */
function openSignup() {
  signupModal.style.display = "flex";
}
function openLogin() {
  loginModal.style.display = "flex";

  dataLayer.push({ event:"login_initiated" });
  digitalData.event.push({ eventInfo:{ eventName:"login_initiated" }});
}

/* ---------- SIGNUP ---------- */
function signup() {
  const email = suEmail.value;
  const pass = suPass.value;

  if (!email || !pass) return alert("Fill all fields");

  const users = getUsers();
  users.push({ email, pass });
  saveUsers(users);

  digitalData.event.push({ eventInfo:{ eventName:"signup_success" }});

  signupModal.style.display="none";
  alert("Signup successful, now login");
}

/* ---------- LOGIN ---------- */
function login() {
  const email = liEmail.value;
  const pass = liPass.value;
  const users = getUsers();

  const valid = users.find(u => u.email===email && u.pass===pass);

  if (!valid) {
    dataLayer.push({ event:"login_failed" });
    digitalData.event.push({ eventInfo:{ eventName:"login_failed" }});
    return alert("Invalid credentials");
  }

  localStorage.setItem("loggedInUser", email);

  dataLayer.push({ event:"login_success" });
  digitalData.event.push({ eventInfo:{ eventName:"login_success" }});

  loginModal.style.display="none";
  updateAuthUI();
  alert("Logged in");
}

/* ---------- LOGOUT ---------- */
function logout() {
  localStorage.removeItem("loggedInUser");

  dataLayer.push({ event:"logout" });
  digitalData.event.push({ eventInfo:{ eventName:"logout" }});

  updateAuthUI();
}
</script>

</body>
</html>
